<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin Panel</title>
<style>
body { font-family: Arial; padding: 20px; background: #f0f2f5; }
input, textarea, select {
  width: 100%; padding: 8px; margin: 6px 0; border-radius: 6px; border: 1px solid #ccc;
}
button {
  padding: 10px 15px; background: #1a73e8; color: white; border: none;
  border-radius: 8px; cursor: pointer;
}
.table { width:100%; border-collapse: collapse; margin-top:20px; }
.table td { padding:10px; border-bottom:1px solid #ddd; }
</style>
</head>
<body>

<h2>ADMIN - Kirim Tugas</h2>

<label>Nama Tugas</label>
<input id="nama">

<label>Deskripsi</label>
<textarea id="desc" rows="3"></textarea>

<label>Deadline</label>
<input id="deadline" type="date">

<label>Untuk User</label>
<input id="user">

<button onclick="kirimTugas()">Kirim</button>
<p id="status"></p>

<h3>Preview Semua Tugas</h3>
<div id="preview">Memuat...</div>

<script>
// ===== GANTI DENGAN WEB APP MU =====
const API_URL = "PASTE_URL_WEBAPP_DI_SINI"; 

function qs(id){ return document.getElementById(id); }

async function kirimTugas(){
  const nama = qs('nama').value.trim();
  const desc = qs('desc').value.trim();
  const deadline = qs('deadline').value;
  const user = qs('user').value.trim();

  if(!nama || !desc || !deadline || !user){
    qs('status').innerText = "Semua field wajib diisi!";
    return;
  }

  qs('status').innerText = "Mengirim...";

  try{
    const res = await fetch(API_URL, {
      method: "POST",
      headers: {"Content-Type":"application/json"},
      body: JSON.stringify({nama, desc, deadline, user})
    });

    const text = await res.text();

    if(!res.ok){
      qs('status').innerText = "Gagal: " + text;
      return;
    }

    qs('status').innerText = "Tugas berhasil dikirim!";
    clearForm();
    loadPreview();

  }catch(err){
    qs('status').innerText = "Error jaringan: " + err;
  }
}

function clearForm(){
  qs('nama').value = "";
  qs('desc').value = "";
  qs('deadline').value = "";
  qs('user').value = "";
}

async function loadPreview(){
  const cont = qs('preview');
  cont.innerHTML = "Memuat...";

  try{
    const r = await fetch(API_URL);
    const rows = await r.json();

    if(!rows.length){
      cont.innerHTML = "Belum ada tugas.";
      return;
    }

    let html = `<table class="table"><tbody>`;

    rows.forEach(r=>{
      html += `
        <tr>
          <td>
            <strong>${escape(r[0])}</strong><br>
            <small>${escape(r[1])}</small>
          </td>
          <td style="text-align:right;">
            Untuk: ${escape(r[3])}<br>
            Deadline: ${escape(r[2])}
          </td>
        </tr>`;
    });

    html += `</tbody></table>`;
    cont.innerHTML = html;

  }catch(err){
    cont.innerHTML = "Gagal memuat.";
  }
}

function escape(s){
  if(!s) return "";
  return s.replace(/[&<>"']/g, m => ({
    '&':'&amp;', '<':'&lt;', '>':'&gt;', '"':'&quot;', "'":'&#39;'
  }[m]));
}

window.onload = loadPreview;
</script>

</body>
</html>
